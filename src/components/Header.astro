---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  src: string | ImageMetadata;     // ← acepta string público o import
  alt?: string;
  class?: string;
  width?: number | string;
  height?: number | string;
  widths?: number[];
  sizes?: string;
  loading?: 'lazy' | 'eager';
  fetchpriority?: 'high' | 'low' | 'auto';
}

const props = Astro.props as Props;
const isStringSrc = typeof props.src === 'string';
---

{isStringSrc ? (
  // Ruta pública (p. ej. /images/Avatar.jpeg) → <img>
  <img
    src={props.src as string}
    alt={props.alt ?? ''}
    class={props.class}
    width={props.width as any}
    height={props.height as any}
    loading={props.loading}
    fetchpriority={props.fetchpriority}
  />
) : (
  // Import local (ImageMetadata) → <Image> optimizado
  <Image
    src={props.src as ImageMetadata}
    alt={props.alt ?? ''}
    class={props.class}
    width={typeof props.width === 'number' ? (props.width as number) : undefined}
    height={typeof props.height === 'number' ? (props.height as number) : undefined}
    widths={props.widths}
    sizes={props.sizes}
    loading={props.loading}
  />
)}
